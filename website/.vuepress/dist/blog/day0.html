<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Day 0 - The groundstation, discovery book, and teensy | NimbleFlight</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="Flight controller software">
    
    <link rel="preload" href="/nimbleflight/assets/css/0.styles.37bdf97b.css" as="style"><link rel="preload" href="/nimbleflight/assets/js/app.0ac2f78a.js" as="script"><link rel="preload" href="/nimbleflight/assets/js/2.0475dad8.js" as="script"><link rel="preload" href="/nimbleflight/assets/js/7.d8911d31.js" as="script"><link rel="prefetch" href="/nimbleflight/assets/js/10.c6354be0.js"><link rel="prefetch" href="/nimbleflight/assets/js/11.c67a5c39.js"><link rel="prefetch" href="/nimbleflight/assets/js/12.a88d2d3c.js"><link rel="prefetch" href="/nimbleflight/assets/js/13.0337e152.js"><link rel="prefetch" href="/nimbleflight/assets/js/3.a58a7520.js"><link rel="prefetch" href="/nimbleflight/assets/js/4.0a222a8c.js"><link rel="prefetch" href="/nimbleflight/assets/js/5.9313a63c.js"><link rel="prefetch" href="/nimbleflight/assets/js/6.17d5dd20.js"><link rel="prefetch" href="/nimbleflight/assets/js/8.80f71c39.js"><link rel="prefetch" href="/nimbleflight/assets/js/9.92794fa0.js">
    <link rel="stylesheet" href="/nimbleflight/assets/css/0.styles.37bdf97b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/nimbleflight/" class="home-link router-link-active"><!----> <span class="site-name">NimbleFlight</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/nimbleflight/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/nimbleflight/docs/" class="nav-link">
  Docs
</a></div><div class="nav-item"><a href="/nimbleflight/blog/" class="nav-link router-link-active">
  Blog
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/nimbleflight/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/nimbleflight/docs/" class="nav-link">
  Docs
</a></div><div class="nav-item"><a href="/nimbleflight/blog/" class="nav-link router-link-active">
  Blog
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/nimbleflight/blog/" aria-current="page" class="sidebar-link">Overview</a></li><li><a href="/nimbleflight/blog/day0.html" aria-current="page" class="active sidebar-link">Day 0 - The groundstation, discovery book, and teensy</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/nimbleflight/blog/day0.html#the-groundstation" class="sidebar-link">The groundstation</a></li><li class="sidebar-sub-header"><a href="/nimbleflight/blog/day0.html#the-stack" class="sidebar-link">The Stack</a></li><li class="sidebar-sub-header"><a href="/nimbleflight/blog/day0.html#overview-and-current-status" class="sidebar-link">Overview and current status</a></li></ul></li><li><a href="/nimbleflight/blog/day1.html" class="sidebar-link">Day 1 - Getting some form of logging working</a></li><li><a href="/nimbleflight/blog/day2.html" class="sidebar-link">Day 2 - The onboard sensors</a></li><li><a href="/nimbleflight/blog/day3.html" class="sidebar-link">Day 3 - Recieving input from a controller</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="day-0-the-groundstation-discovery-book-and-teensy"><a href="#day-0-the-groundstation-discovery-book-and-teensy" class="header-anchor">#</a> Day 0 - The groundstation, discovery book, and teensy</h1> <p>Day0 is sort of odd, because I started this project while studying for exams and finishing final projects, basically instead of taking a netflix break I would just work on the groundstation in js. Due to this, there wasn't really a defined goal but mainly me just messing around doing whatever I could in an hour or so here or there.</p> <p></p><div class="table-of-contents"><ul><li><a href="#the-groundstation">The groundstation</a></li><li><a href="#the-stack">The Stack</a><ul><li><a href="#the-chart-library">The chart library</a></li><li><a href="#_3d-rendering-library">3D rendering library</a></li><li><a href="#map-api">Map API</a></li><li><a href="#reactive-framework">Reactive framework</a></li></ul></li><li><a href="#overview-and-current-status">Overview and current status</a></li></ul></div><p></p> <h2 id="the-groundstation"><a href="#the-groundstation" class="header-anchor">#</a> The groundstation</h2> <p>Most of the time I spent doing JS stuff on the ground station. To begin I came up with its functionality, based on both what i wanted and other industry grade solutions, then came up with the basic layout and GUI of the system.</p> <p><img src="/groundstation_sketch.jpg" alt="groundstation sketch" title="Groundstation sketch"></p> <p>As you can probably tell I am not an artist but it lays out what it should look like and gives a key overview for the different functionality.</p> <ul><li>on the left we can see the charts showing realtime updates to acceleration, altitude, and orientation</li> <li>at the top center we get controls to go back through old data and look for performance and debugging data. This is key for me because in the event I am not able to get real time updates, using the logs from onboard the device allows me to see the flight after.</li> <li>Below that is the video the drone is taking, which i still have no clue how to implement and is far down the line</li> <li>The orientation viewer is a way for me to better understand the orientation of the drone rather than decypher it from the graph. (side node: it was very tempting to write my own renderer as I have work as a graphics programmer in the past, but three.js is just amazing).</li> <li>The command prompt is a way for me to control the drone, so if I want to switch its mode, update sensitivities, or if i want to modify how the groundstation is working, like updating from realtime to loading the data from a file.</li> <li>The horizon i have now scraped as I can see it from the orientation viewer</li> <li>Lastly the GPS map shows where the drone is and where my computer is relative to each other and helps me better locate the drone in case of a crash. It's also just a cool visual.</li></ul> <h2 id="the-stack"><a href="#the-stack" class="header-anchor">#</a> The Stack</h2> <p>Why the web? The gist of it is i'm more comfortable with the web than I am Qt or another GUI environment, and although I could use it as a learning experience to see how they work, I figure the goal of the project is a drone not a groundstation.</p> <p>To implement this I knew I needed a few things, a chart library, a 3d rendering library, probably a reactive framework, and a map api. For styling, tailwindcss is just a given for me.</p> <h3 id="the-chart-library"><a href="#the-chart-library" class="header-anchor">#</a> The chart library</h3> <p>Here I choose to go with the first thing I found as it was the most popular on NPM, it was heavily documented, and it looked pretty, <a href="https://www.chartjs.org/" target="_blank" rel="noopener noreferrer">Chart.js<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. Fortunately, or unfortunately, there is not much to say about the library as it does exactly what is says it will, which I think is my favorite type of library. I believe I have found one bug with turning animations off but I will look into it more when I have time.</p> <h3 id="_3d-rendering-library"><a href="#_3d-rendering-library" class="header-anchor">#</a> 3D rendering library</h3> <p>For the orientation viewer and maybe other things in the future I needed a way to renderer 3D visuals. With my previous experience in graphics it was extremely tempting to write it in webgl from scratch but since the goal is the <strong>drone</strong> and not the pretty groundstation I decided to delegate to a library I had used in the past Three.js.</p> <h3 id="map-api"><a href="#map-api" class="header-anchor">#</a> Map API</h3> <p>For the Map API I was debating between google maps and openstreetmap when I found leaflet.js which walked me through the steps to get up and running and uses Openstreetmap in its tutorial so I have choosen to use it.</p> <h3 id="reactive-framework"><a href="#reactive-framework" class="header-anchor">#</a> Reactive framework</h3> <p>I initally started out thinking I would use React, Vue or Svelte but quickly realized the entire landscape had changed since I had last used a framework. No longer were create-react-app and vue-cli the &quot;correct&quot; way of doing things, neither was webpack anymore. Frusterated with this insane pace of change, I dropped back to vanilla js and where I need reactivity I use RxJs, which has been a wonder to work with. I basically just use a nodejs backend which monitors a serial port and pushes that through a websocket to the RxJs websocketsubject which each widget subscribes to in order to update their data.</p> <h2 id="overview-and-current-status"><a href="#overview-and-current-status" class="header-anchor">#</a> Overview and current status</h2> <p>The current solution looks like this</p> <p><img src="/groundstation_day0.png" alt="day0 groundstation"></p> <p>As you can see it looks pretty similar to the sketch with some minor changes. First I added a compass to the orientation viewer to better understand where the drone is looking, also the ordering of the widgets are different. This is because in the future I am going to allow the user to drag, drop and resize them to fit their need.</p> <h1 id="the-discovery-book"><a href="#the-discovery-book" class="header-anchor">#</a> The discovery book</h1> <p>Probably the thing I should have worked on instead of the groundstation was the discovery book, although I just finished a course in embedded programming and did well in the course, most of it was based around Arduino and using IDEs provided by the microcontroller (MCU) manufacturer. For some reason using I don't feel like I fully understand what is happening when using those tools, and although I have become productive with them the goal of this project is really to learn what going on behind the scenes.</p> <p>The discovery book was a fantastic start to embedded programming in Rust, with my background, it provided everything I needed to fully understand what was happening each step of the process and have useful challenges (and hints) for doing things like turning on led. Thank you to all who worked on it.</p> <p>I did however run into some issues with chapter 11, which even with the provided code would not compile. I found the github issue for it and now understand that the book is moving to a new board instead of the stm32f3discovery. I had wished the book was kept in a working state but understand that this is open source and people's free time. I hope in the future I may be able to contribute to it.</p> <p>Overall, it provided a great platform for me to better understand and further persue embedded programming.</p> <h1 id="teensy-4-0"><a href="#teensy-4-0" class="header-anchor">#</a> Teensy 4.0</h1> <p>Other than the stm32f3 I plan on using the teensy along with an xbee radio to relay data to the groundstation but for the current testing phase of getting the onboard (stm32) sensors to work I though using the on board usb. I cannot for the life of me to get it to work, so I have come up with the hackiest of all hacks and used the normal UART to communicate with the teensy and have that forward it through the Arduino Serial library to the computer.</p> <h1 id="conclusion"><a href="#conclusion" class="header-anchor">#</a> Conclusion</h1> <p>Honestly these first few days of working of the project give me quite a lot of excitement and I am happy with the progress so far. Sometime after exams I will get started on the onboard sensors and then datapipeline</p> <ul><li>write the hack with the teensy</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/nimbleflight/blog/" class="prev router-link-active">
        Overview
      </a></span> <span class="next"><a href="/nimbleflight/blog/day1.html">
        Day 1 - Getting some form of logging working
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/nimbleflight/assets/js/app.0ac2f78a.js" defer></script><script src="/nimbleflight/assets/js/2.0475dad8.js" defer></script><script src="/nimbleflight/assets/js/7.d8911d31.js" defer></script>
  </body>
</html>
